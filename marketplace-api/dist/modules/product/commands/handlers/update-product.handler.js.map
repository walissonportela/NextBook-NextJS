{"version":3,"sources":["../../../../../src/modules/product/commands/handlers/update-product.handler.ts"],"sourcesContent":["import { ICommandHandler, CommandHandler } from \"@nestjs/cqrs\";\nimport { UpdateProductCommand } from \"../impl/update-product.command\";\nimport { PrismaService } from \"src/core/infra/database/prisma.service\";\nimport { NotFoundException } from \"@nestjs/common\";\n\n@CommandHandler(UpdateProductCommand)\nexport class UpdateProductHandler implements ICommandHandler<UpdateProductCommand> {\n    constructor(private readonly prismaService: PrismaService) {}\n\n    async execute(command: UpdateProductCommand) {\n        const { id, ...updateData } = command.data;\n\n        const filteredData = Object.fromEntries(\n            Object.entries(updateData).filter(([_, value]) => value !== undefined)\n        );\n\n        const product = await this.prismaService.product.update({\n            where: { id },\n            data: {\n                ...filteredData,\n                imageUrl: updateData.imageUrl ? updateData.imageUrl : undefined\n            }\n        });\n\n        if (!product) {\n            throw new NotFoundException(`Product with ID ${id} not found`);\n        }\n\n        return product;\n    }\n}\n"],"names":["UpdateProductHandler","execute","command","id","updateData","data","filteredData","Object","fromEntries","entries","filter","_","value","undefined","product","prismaService","update","where","imageUrl","NotFoundException"],"mappings":";;;;+BAMaA;;;eAAAA;;;sBANmC;sCACX;+BACP;wBACI;;;;;;;;;;AAG3B,IAAA,AAAMA,uBAAN,MAAMA;IAGT,MAAMC,QAAQC,OAA6B,EAAE;QACzC,MAAM,EAAEC,EAAE,EAAE,GAAGC,YAAY,GAAGF,QAAQG,IAAI;QAE1C,MAAMC,eAAeC,OAAOC,WAAW,CACnCD,OAAOE,OAAO,CAACL,YAAYM,MAAM,CAAC,CAAC,CAACC,GAAGC,MAAM,GAAKA,UAAUC;QAGhE,MAAMC,UAAU,MAAM,IAAI,CAACC,aAAa,CAACD,OAAO,CAACE,MAAM,CAAC;YACpDC,OAAO;gBAAEd;YAAG;YACZE,MAAM;gBACF,GAAGC,YAAY;gBACfY,UAAUd,WAAWc,QAAQ,GAAGd,WAAWc,QAAQ,GAAGL;YAC1D;QACJ;QAEA,IAAI,CAACC,SAAS;YACV,MAAM,IAAIK,yBAAiB,CAAC,CAAC,gBAAgB,EAAEhB,GAAG,UAAU,CAAC;QACjE;QAEA,OAAOW;IACX;IAtBA,YAAY,AAAiBC,aAA4B,CAAE;aAA9BA,gBAAAA;IAA+B;AAuBhE"}