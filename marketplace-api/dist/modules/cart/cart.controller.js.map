{"version":3,"sources":["../../../src/modules/cart/cart.controller.ts"],"sourcesContent":["import { Body, Controller, Post, Delete, Patch, Get, Req } from \"@nestjs/common\";\nimport { CommandBus, QueryBus } from \"@nestjs/cqrs\";\nimport { AddProductToCartDto } from \"./commands/dto/add-product-to-cart.dto\";\nimport { RemoveProductFromCartDto } from \"./commands/dto/remove-product-from-cart.dto\";\nimport { DecreaseProductQuantityDto } from \"./commands/dto/decrease-product-quantity.dto\";\nimport { AddProductToCartImpl } from \"./commands/impl/add-product-to-cart.impl\";\nimport { RemoveProductFromCartImpl } from \"./commands/impl/remove-product-from-cart.impl\";\nimport { DecreaseProductQuantityImpl } from \"./commands/impl/decrease-product-quantity.impl\";\nimport { GetCartQuery } from \"./queries/get-cart.query\";\nimport { Request } from \"express\";\nimport { ApiOperation, ApiResponse, ApiBearerAuth } from \"@nestjs/swagger\";\n\n@Controller(\"cart\")\nexport class CartController {\n    constructor(\n        private readonly commandBus: CommandBus,\n        private readonly queryBus: QueryBus\n    ) { }\n\n    @Get()\n    @ApiOperation({ summary: 'Get user cart with all products and total price' })\n    @ApiResponse({ status: 200, description: 'Cart retrieved successfully' })\n    @ApiResponse({ status: 401, description: 'Unauthorized' })\n    @ApiResponse({ status: 404, description: 'Cart not found' })\n    @ApiBearerAuth()\n    async getCart(@Req() req: Request) {\n        return this.queryBus.execute(new GetCartQuery(req.user.sub));\n    }\n\n    @Post(\"add-product\")\n    @ApiOperation({ summary: 'Add a product to the cart' })\n    @ApiResponse({ status: 201, description: 'Product added to cart successfully' })\n    @ApiResponse({ status: 401, description: 'Unauthorized' })\n    @ApiBearerAuth()\n    async addProductToCart(\n        @Body() addProductToCartDto: AddProductToCartDto,\n        @Req() req: Request\n    ) {\n        return this.commandBus.execute(new AddProductToCartImpl({\n            ...addProductToCartDto,\n            userId: req.user.sub\n        }));\n    }\n\n    @Delete(\"remove-product\")\n    @ApiOperation({ summary: 'Remove a product from the cart' })\n    @ApiResponse({ status: 200, description: 'Product removed from cart successfully' })\n    @ApiResponse({ status: 401, description: 'Unauthorized' })\n    @ApiResponse({ status: 404, description: 'Product not found in cart' })\n    @ApiBearerAuth()\n    async removeProductFromCart(\n        @Body() removeProductFromCartDto: RemoveProductFromCartDto,\n        @Req() req: Request\n    ) {\n        return this.commandBus.execute(new RemoveProductFromCartImpl({\n            ...removeProductFromCartDto,\n            userId: req.user.sub\n        }));\n    }\n\n    @Patch(\"decrease-quantity\")\n    @ApiOperation({ summary: 'Decrease product quantity in the cart' })\n    @ApiResponse({ status: 200, description: 'Product quantity decreased successfully' })\n    @ApiResponse({ status: 401, description: 'Unauthorized' })\n    @ApiResponse({ status: 404, description: 'Product not found in cart' })\n    @ApiBearerAuth()\n    async decreaseProductQuantity(\n        @Body() decreaseProductQuantityDto: DecreaseProductQuantityDto,\n        @Req() req: Request\n    ) {\n        return this.commandBus.execute(new DecreaseProductQuantityImpl({\n            ...decreaseProductQuantityDto,\n            userId: req.user.sub\n        }));\n    }\n}"],"names":["CartController","getCart","req","queryBus","execute","GetCartQuery","user","sub","addProductToCart","addProductToCartDto","commandBus","AddProductToCartImpl","userId","removeProductFromCart","removeProductFromCartDto","RemoveProductFromCartImpl","decreaseProductQuantity","decreaseProductQuantityDto","DecreaseProductQuantityImpl","summary","status","description"],"mappings":";;;;+BAaaA;;;eAAAA;;;wBAbmD;sBAC3B;qCACD;0CACK;4CACE;sCACN;2CACK;6CACE;8BACf;yBACL;yBACiC;;;;;;;;;;;;;;;AAGlD,IAAA,AAAMA,iBAAN,MAAMA;IAMT,MAMMC,QAAQ,AAAOC,GAAY,EAAE;QAC/B,OAAO,IAAI,CAACC,QAAQ,CAACC,OAAO,CAAC,IAAIC,0BAAY,CAACH,IAAII,IAAI,CAACC,GAAG;IAC9D;IAEA,MAKMC,iBACF,AAAQC,mBAAwC,EAChD,AAAOP,GAAY,EACrB;QACE,OAAO,IAAI,CAACQ,UAAU,CAACN,OAAO,CAAC,IAAIO,0CAAoB,CAAC;YACpD,GAAGF,mBAAmB;YACtBG,QAAQV,IAAII,IAAI,CAACC,GAAG;QACxB;IACJ;IAEA,MAMMM,sBACF,AAAQC,wBAAkD,EAC1D,AAAOZ,GAAY,EACrB;QACE,OAAO,IAAI,CAACQ,UAAU,CAACN,OAAO,CAAC,IAAIW,oDAAyB,CAAC;YACzD,GAAGD,wBAAwB;YAC3BF,QAAQV,IAAII,IAAI,CAACC,GAAG;QACxB;IACJ;IAEA,MAMMS,wBACF,AAAQC,0BAAsD,EAC9D,AAAOf,GAAY,EACrB;QACE,OAAO,IAAI,CAACQ,UAAU,CAACN,OAAO,CAAC,IAAIc,wDAA2B,CAAC;YAC3D,GAAGD,0BAA0B;YAC7BL,QAAQV,IAAII,IAAI,CAACC,GAAG;QACxB;IACJ;IA5DA,YACI,AAAiBG,UAAsB,EACvC,AAAiBP,QAAkB,CACrC;aAFmBO,aAAAA;aACAP,WAAAA;IACjB;AA0DR;;;;QAvDoBgB,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;QAOzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;;QAazBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;;QAazBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa"}